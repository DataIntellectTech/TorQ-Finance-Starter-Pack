
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../graphics/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>Architecture - Finance Starter Pack</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-51911331-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
  <script async src="https://www.google-analytics.com/analytics.js"></script>


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="grey">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Finance Starter Pack" class="md-header__button md-logo" aria-label="Finance Starter Pack" data-md-component="logo">
      
  <img src="../graphics/DataIntellect-header-logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Finance Starter Pack
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Architecture
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/AquaQAnalytics/TorQ" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Finance Starter Pack" class="md-nav__button md-logo" aria-label="Finance Starter Pack" data-md-component="logo">
      
  <img src="../graphics/DataIntellect-header-logo.jpg" alt="logo">

    </a>
    Finance Starter Pack
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AquaQAnalytics/TorQ" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Architecture
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Architecture
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#processes" class="md-nav__link">
    Processes
  </a>
  
    <nav class="md-nav" aria-label="Processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feed" class="md-nav__link">
    Feed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdb" class="md-nav__link">
    RDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wdb-and-sort-processes" class="md-nav__link">
    WDB and Sort Processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gateway" class="md-nav__link">
    Gateway
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-engine" class="md-nav__link">
    Report Engine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#housekeeping" class="md-nav__link">
    Housekeeping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compression" class="md-nav__link">
    Compression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discovery" class="md-nav__link">
    Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor" class="md-nav__link">
    Monitor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    Metrics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-advantages-does-this-give-me" class="md-nav__link">
    What Advantages Does This Give Me?
  </a>
  
    <nav class="md-nav" aria-label="What Advantages Does This Give Me?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-of-day" class="md-nav__link">
    End Of Day
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gateway-resilience-load-balancing-and-parallel-access" class="md-nav__link">
    Gateway: Resilience, Load Balancing and Parallel Access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supportability" class="md-nav__link">
    Supportability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../play/" class="md-nav__link">
        Have a Play
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../iex/" class="md-nav__link">
        IEX
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#processes" class="md-nav__link">
    Processes
  </a>
  
    <nav class="md-nav" aria-label="Processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feed" class="md-nav__link">
    Feed
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rdb" class="md-nav__link">
    RDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wdb-and-sort-processes" class="md-nav__link">
    WDB and Sort Processes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gateway" class="md-nav__link">
    Gateway
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-engine" class="md-nav__link">
    Report Engine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#housekeeping" class="md-nav__link">
    Housekeeping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compression" class="md-nav__link">
    Compression
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discovery" class="md-nav__link">
    Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor" class="md-nav__link">
    Monitor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    Metrics
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-advantages-does-this-give-me" class="md-nav__link">
    What Advantages Does This Give Me?
  </a>
  
    <nav class="md-nav" aria-label="What Advantages Does This Give Me?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#end-of-day" class="md-nav__link">
    End Of Day
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gateway-resilience-load-balancing-and-parallel-access" class="md-nav__link">
    Gateway: Resilience, Load Balancing and Parallel Access
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supportability" class="md-nav__link">
    Supportability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/AquaQAnalytics/TorQ/edit/master/docs/architecture.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="architecture">Architecture</h1>
<p>This section will be used to describe the different features included
within the Finance Starter Pack. For more information on TorQ
implementation details you can refer to the <a href="https://aquaqanalytics.github.io/TorQ/">TorQ
Manual</a>,
review the code which comprises the system or contact us at
<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#105;&#110;&#102;&#111;&#64;&#100;&#97;&#116;&#97;&#105;&#110;&#116;&#101;&#108;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;">&#105;&#110;&#102;&#111;&#64;&#100;&#97;&#116;&#97;&#105;&#110;&#116;&#101;&#108;&#108;&#101;&#99;&#116;&#46;&#99;&#111;&#109;</a>.</p>
<h2 id="processes">Processes</h2>
<p>The architecture of the demo system is as below.</p>
<p><img alt="Demo Data Capture" src="../graphics/fullarchitecture.png" /></p>
<h3 id="feed">Feed</h3>
<p>The feed comprises two randomly generated tables, trade and quote. These
tables have ’ticks’ generated by feed.q which are pushed to the
tickerplant in batches every 200 milliseconds. A large batch is pushed
initially then smaller batches after it. The timestamps are local time.</p>
<p>The schema definitions can be seen below and can also be viewed in the
file tick/database.q which will be located under the directory you
extract the TorQ and Starter Pack files to.</p>
<pre><code>quote:([]time:`timestamp$(); sym:`g#`symbol$(); bid:`float$(); ask:`float$(); bsize:`long$(); asize:`long$(); mode:`char$(); ex:`symbol$())
trade:([]time:`timestamp$(); sym:`g#`symbol$(); price:`float$(); size:`int$(); stop:`boolean$(); cond:`char$(); ex:`symbol$())

meta quote
c    | t f a
-----| -----
time | p    
sym  | s   g
bid  | f    
ask  | f    
bsize| j    
asize| j    
mode | c    
ex   | s

meta trade
c    | t f a
-----| -----
time | p    
sym  | s   g
price| f    
size | i    
stop | b    
cond | c    
ex   | s
</code></pre>
<h3 id="rdb">RDB</h3>
<p>The RDB is a TorQ process which holds data for the current GMT day in
memory. Unlike kdb+tick, it does not persist data to disk at end-of-day.</p>
<h3 id="wdb-and-sort-processes">WDB and Sort Processes</h3>
<p>The WDB is a specilized database process which subscribes to a
tickerplant and periodically persists data to disk. At EOD this data is
used to create the HDB partition. It has been configured to operate in
conjuction with a sorting process which sorts the data it writes to
disk.</p>
<p>The sorting process is configured to sort by sym(p#) and time, although
this can be configured on a per-table basis in $KDBCONFIG/sort.csv</p>
<h3 id="gateway">Gateway</h3>
<p>The gateway connects to the RDB and HDB processes and runs queries
against them. It can access a single process, or join data across
multiple processes. It also does load balancing and implements a level
of resilience by hiding back end process failure from clients. Later in
this document in the Have a Pay chapter a number of example queries are
provided which demonstrate the functionality of the gateway process</p>
<h3 id="report-engine">Report Engine</h3>
<p>The Report Engine runs queries on a schedule against specific back end
processes, including gateways. Once the report is complete the result
can be further processed, with available actions such as emailing it out
or writing it to a file. This has been used to implement some basic
monitoring checks and run some end of day reports. The configuration
file is in $KDBCONFIG/reporter.csv.</p>
<h3 id="housekeeping">Housekeeping</h3>
<p>The housekeeping process is used to maintain some of the files written
to disk by TorQ. In the demo we use it to archive tplogs and both
archive and eventually remove log files from the TorQ working
directories.</p>
<p>The process has been configured like so:</p>
<pre><code>zip,{KDBLOG}/,*.log,,10
rm,{KDBLOG}/,*.gz,,30
zip,{KDBTPLOG}/,database20*,,1
</code></pre>
<p>The first line can be translated to mean ’Compress the files in the
KDBLOG/ path, matching the *.log pattern, excluding no files and
where the files are older than 10 days’</p>
<p>Combined with the other lines, the system will compress process logs
after 10 days, delete compressed process logs after 30 days and compress
tplogs after 1 day.</p>
<p>The compression process will check for work to be done everyday at 0200
local time.</p>
<h3 id="compression">Compression</h3>
<p>The compression process is used to periodically scan the hdb directory
for columnar binary files to compress. The compression settings are
defined in $KDBCONFIG/compressionconfig.csv. This allows configuration
of compression parameters on a per table, column and age basis.</p>
<p>It is intended to be used with a scheduling program like cron. By
default it is a transient process as it will start up, check for files
to compress, does any work required and then dies.</p>
<h3 id="discovery">Discovery</h3>
<p>The discovery process is used by the other processes to locate other
processes of interest, and register their own capabilities.</p>
<h3 id="monitor">Monitor</h3>
<p>The monitor process is a basic monitoring process to show process
avaiability via heartbeating, and to display error messages published by
other processes.</p>
<h3 id="metrics">Metrics</h3>
<p>A simple metrics engine is provided as an example of a real-time
subscriber process. This process subscribes to updates from the 
tickerplant, and provides TWAP and VWAP metrics for configurable time
windows. On connection it subscribes to the tickerplant and attempts 
to recover relevant data up until that point from the RDB. </p>
<p>The settings are shown here:</p>
<table>
<thead>
<tr>
<th align="center">Settings</th>
<th align="center">Type</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">.metrics.windows</td>
<td align="center">timespan (list)</td>
<td align="center">List of time windows over which to perform metrics</td>
</tr>
<tr>
<td align="center">.metrics.enableallday</td>
<td align="center">boolean</td>
<td align="center">Boolean to enable the "all day" window in addition to above windows</td>
</tr>
</tbody>
</table>
<h2 id="what-advantages-does-this-give-me">What Advantages Does This Give Me?</h2>
<p>A standard kdb+tick set up is great for a lot of installations but some
customers have modified it substantially to fit their needs.</p>
<h3 id="end-of-day">End Of Day</h3>
<p>In a standard kdb+tick setup, the end-of-day event is time consuming and
the data is unavailable as it is written from the RDB memory to the HDB
disk. With the above setup, this outage is minimized in the following
ways:</p>
<ul>
<li>
<p>Faster end-of-day as data is written periodically to disk throughout
    the day</p>
</li>
<li>
<p>No back-pressure (slow subscriber problem) on the tickerplant as the
    RDB doesn’t write to disk, and the WDB doesn’t do the time consuming
    sort on the data</p>
</li>
<li>
<p>“Yesterday’s” data is available in the RDB until the end-of-day
    operation is complete, meaning no data outage</p>
</li>
</ul>
<h3 id="gateway-resilience-load-balancing-and-parallel-access">Gateway: Resilience, Load Balancing and Parallel Access</h3>
<p>kdb+tick doesn’t include a gateway as standard. There are some examples
on code.kx, but production gateways are generally non trivial to write.
The TorQ gateway ensures</p>
<ul>
<li>
<p>Backend processes can be replicated as required. If one process
    fails, another will take over transparently to the client</p>
</li>
<li>
<p>New processes can be started intraday and will be automatically
    available via Discovery Service notifications</p>
</li>
<li>
<p>Queries are run in parallel and load balanced across back end
    processes- multiple clients can query at once</p>
</li>
</ul>
<h3 id="supportability">Supportability</h3>
<p>TorQ adds a layer of standard tools to aid system supportability on top
of kdb+tick.</p>
<ul>
<li>
<p>Common directories for loading code in a fault tolerant way</p>
</li>
<li>
<p>Output and error log messages are timestamped and standardized</p>
</li>
<li>
<p>Log messages can be published to external applications</p>
</li>
<li>
<p>All client queries are logged and timed, and can be externally
    published</p>
</li>
<li>
<p>Monitoring checks are incorporated</p>
</li>
<li>
<p>Email notifications are incorporated</p>
</li>
<li>
<p>Housekeeping automatically executed</p>
</li>
</ul>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../gettingstarted/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Getting Started" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Getting Started
            </div>
          </div>
        </a>
      
      
        
        <a href="../play/" class="md-footer__link md-footer__link--next" aria-label="Next: Have a Play" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Have a Play
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/AquaQAnalytics" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/data_intellect" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/company/data-intellect-challenge-accepted" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
    
  </body>
</html>